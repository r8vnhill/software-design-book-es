% \listfiles
\RequirePackage{scrlfile}
\ReplaceClass{article}{book}
\documentclass{ltxdoc}
% \documentclass[12pt]{book}
\usepackage{fontspec}
\usepackage[dvipsnames]{xcolor}
\usepackage{minted}
\usepackage[skins, minted, breakable]{tcolorbox}
\usepackage{expl3}
\usepackage{xparse}
\title{Title}

\author{Author}

\date{\today}

\definecolor{LightGray}{gray}{0.9}
\definecolor{Transparent}{gray}{1.0}

\ExplSyntaxOn
% | Creates a new tcolorbox environment with enhanced borders, breakable content, and a title.
\NewDocumentEnvironment { defaultbox } { o +b } {
  \IfNoValueTF {#1} {
    \begin{tcolorbox}[enhanced, breakable]
      #2
    \end{tcolorbox}
  } {
    \begin{tcolorbox}[enhanced, breakable, title=#1]
      #2
    \end{tcolorbox}
  }
} {}
\ExplSyntaxOff

\newtcblisting{powershell}{
   enhanced,
   breakable,
   listing engine=minted,
   minted style=emacs,
   minted language=powershell,
   minted options={autogobble},
   colback=blue!5!white,
   colframe=Cerulean!75!black,
   listing only,
   left=5mm,enhanced,
   overlay={
      \begin{tcbclipinterior}
         \fill[Cerulean!20!white] (frame.south west) rectangle ([xshift=5mm]frame.north west);
      \end{tcbclipinterior}
   }
}

\tcbuselibrary{documentation}

\setmainfont{Minion Pro}
\setmonofont{Fira Mono for Powerline}[Scale=MatchLowercase]

\tcbset{listing engine=minted, colframe=Orchid!75!black}


\begin{document}
  \begin{defaultbox}[Box Title]
    Text
    \begin{powershell}
      [Net.ServicePointManager]::SecurityProtocol = `
        [Net.SecurityProtocolType]::Tls12
      Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force
      Invoke-WebRequest "https://chocolatey.org/install.ps1" `
        -UseBasicParsing | Invoke-Expression
    \end{powershell}
  \end{defaultbox}
\end{document}